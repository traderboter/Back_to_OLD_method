# ØªØ­Ù„ÛŒÙ„ Ú©Ø§Ù…Ù„ ÙØ±Ø¢ÛŒÙ†Ø¯ ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ - Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ (NEW SYSTEM)

## Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ø³Ù†Ø¯ ØªÙˆØ¶ÛŒØ­ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ Ú©Ù‡ Ø¯Ø± **Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ Ù…Ø§Ú˜ÙˆÙ„Ø§Ø±** ÙˆÙ‚ØªÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú†Ù‡Ø§Ø± ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ… (5m, 15m, 1h, 4h) Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ùˆ Ø§ÛŒØ¬Ø§Ø¯ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ØŒ Ú†Ù‡ Ø§ØªÙØ§Ù‚Ø§ØªÛŒ Ù…ÛŒâ€ŒØ§ÙØªØ¯. Ø¯Ø± Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ…ØŒ **Ø³ÛŒÚ¯Ù†Ø§Ù„ Ù†Ù‡Ø§ÛŒÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ (Scoring) Ø¨Ø§ 13 Ø¶Ø±ÛŒØ¨ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯** Ú©Ù‡ ØªØ±Ú©ÛŒØ¨ÛŒ Ø§Ø² ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø§Ø³Øª.

### ØªÙØ§ÙˆØªâ€ŒÙ‡Ø§ÛŒ Ø¨Ù†ÛŒØ§Ø¯ÛŒ Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ

| Ø¬Ù†Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ (OLD) | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ (NEW) |
|------|------------------|------------------|
| **Ù…Ø¹Ù…Ø§Ø±ÛŒ** | Monolithic (ØªÚ©â€ŒØ¨Ù„ÙˆÚ©ÛŒ) | Modular (Ù…Ø§Ú˜ÙˆÙ„Ø§Ø±) |
| **Ù†Ù‚Ø·Ù‡ ÙˆØ±ÙˆØ¯** | SignalGenerator | SignalOrchestrator |
| **ØªØ¹Ø¯Ø§Ø¯ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§** | 1 ÙØ§ÛŒÙ„ Ø¨Ø²Ø±Ú¯ | 90+ ÙØ§ÛŒÙ„ Ù…Ø³ØªÙ‚Ù„ |
| **Analyzers** | Ù…ØªØ¯Ù‡Ø§ÛŒ Ø¯Ø±ÙˆÙ† Ú©Ù„Ø§Ø³ | 11 Ú©Ù„Ø§Ø³ Ù…Ø³ØªÙ‚Ù„ |
| **Indicators** | Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾Ø±Ø§Ú©Ù†Ø¯Ù‡ | IndicatorOrchestrator Ù…ØªÙ…Ø±Ú©Ø² |
| **Patterns** | Ú©Ø¯ Ø¯Ø±Ù‡Ù… | 35+ Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø³ØªÙ‚Ù„ |
| **Caching** | Ù†Ø¯Ø§Ø±Ø¯ | TimeframeScoreCache |
| **Testing** | Ø³Ø®Øª | Ø¢Ø³Ø§Ù† (unit test) |
| **Performance** | Ú©Ù†Ø¯ØªØ± | Ø³Ø±ÛŒØ¹â€ŒØªØ± (Ø¨Ø§ cache) |
| **ÙˆØ²Ù†â€ŒØ¯Ù‡ÛŒ** | Ø«Ø§Ø¨Øª | Per-Timeframe Configurable |

### ÙÙ„Ø³ÙÙ‡ Ø·Ø±Ø§Ø­ÛŒ Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯

âœ… **Separation of Concerns**: Ù‡Ø± Ù…Ø§Ú˜ÙˆÙ„ ÛŒÚ© Ù…Ø³Ø¦ÙˆÙ„ÛŒØª Ù…Ø´Ø®Øµ Ø¯Ø§Ø±Ø¯
âœ… **Single Responsibility**: Ù‡Ø± Ú©Ù„Ø§Ø³ ÙÙ‚Ø· ÛŒÚ© Ú©Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
âœ… **Dependency Injection**: Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øªâ€ŒÙ‡Ø§ Ø§Ø² config Ø®Ø§Ø±Ø¬ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
âœ… **Context Sharing**: Ù‡Ù…Ù‡ Ø§Ø² ÛŒÚ© AnalysisContext Ù…Ø´ØªØ±Ú© Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ù†Ø¯
âœ… **Cache-First**: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªÚ©Ø±Ø§Ø±ÛŒ
âœ… **Type Safety**: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Enums Ùˆ Constants

### Ù…Ø¹Ù…Ø§Ø±ÛŒ Ú©Ù„ÛŒ (High-Level Architecture)

```
SignalProcessor (ÙˆØ±ÙˆØ¯ÛŒ)
    â†“
SignalOrchestrator (Ù‡Ù…Ø§Ù‡Ù†Ú¯â€ŒÚ©Ù†Ù†Ø¯Ù‡ Ø§ØµÙ„ÛŒ)
    â†“
    â”œâ”€â†’ IndicatorOrchestrator (Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…ØªÙ…Ø±Ú©Ø² 10 Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±)
    â”‚   â””â”€â†’ EMA, SMA, RSI, MACD, Stochastic, ATR, Bollinger, OBV, ADX
    â”‚
    â”œâ”€â†’ 11 Analyzers (ØªØ­Ù„ÛŒÙ„Ú¯Ø±Ø§Ù† Ù…Ø³ØªÙ‚Ù„)
    â”‚   â”œâ”€â†’ TrendAnalyzer (548 Ø®Ø·)
    â”‚   â”œâ”€â†’ MomentumAnalyzer (1303 Ø®Ø·)
    â”‚   â”œâ”€â†’ VolumeAnalyzer (596 Ø®Ø·)
    â”‚   â”œâ”€â†’ VolumePatternAnalyzer (583 Ø®Ø·)
    â”‚   â”œâ”€â†’ PatternAnalyzer (464 Ø®Ø·)
    â”‚   â”‚   â””â”€â†’ PatternOrchestrator â†’ 35+ Ø§Ù„Ú¯Ùˆ (Ú©Ù†Ø¯Ù„ÛŒ + Ú†Ø§Ø±Øª)
    â”‚   â”œâ”€â†’ SRAnalyzer (Support/Resistance - 781 Ø®Ø·)
    â”‚   â”œâ”€â†’ VolatilityAnalyzer (538 Ø®Ø·)
    â”‚   â”œâ”€â†’ HarmonicAnalyzer (495 Ø®Ø·)
    â”‚   â”œâ”€â†’ ChannelAnalyzer (154 Ø®Ø·)
    â”‚   â”œâ”€â†’ CyclicalAnalyzer (371 Ø®Ø·)
    â”‚   â””â”€â†’ HTFAnalyzer (Higher Timeframe - 323 Ø®Ø·)
    â”‚
    â”œâ”€â†’ 4 Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯
    â”‚   â”œâ”€â†’ MarketRegimeDetector (ØªØ´Ø®ÛŒØµ Ø±Ú˜ÛŒÙ… Ø¨Ø§Ø²Ø§Ø±)
    â”‚   â”œâ”€â†’ AdaptiveLearningSystem (ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ ØªØ·Ø¨ÛŒÙ‚ÛŒ)
    â”‚   â”œâ”€â†’ CorrelationManager (Ù…Ø¯ÛŒØ±ÛŒØª Ù‡Ù…Ø¨Ø³ØªÚ¯ÛŒ)
    â”‚   â””â”€â†’ EmergencyCircuitBreaker (Ù…Ø¯Ø§Ø± Ø´Ú©Ù† Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ)
    â”‚
    â”œâ”€â†’ SignalScorer (Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ Ø¨Ø§ 13 Ø¶Ø±ÛŒØ¨ - 876 Ø®Ø·)
    â”œâ”€â†’ MultiTimeframeAggregator (ØªØ±Ú©ÛŒØ¨ TF Ù‡Ø§ - 822 Ø®Ø·)
    â””â”€â†’ SignalValidator (Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ)
         â†“
SignalInfo (Ø®Ø±ÙˆØ¬ÛŒ)
```

### Ø³Ø§Ø®ØªØ§Ø± ÙØ§ÛŒÙ„â€ŒÙ‡Ø§

```
signal_generation/
â”œâ”€â”€ orchestrator.py (1275 Ø®Ø·)              # ğŸ¯ Ù†Ù‚Ø·Ù‡ ÙˆØ±ÙˆØ¯ Ø§ØµÙ„ÛŒ
â”œâ”€â”€ signal_scorer.py (876 Ø®Ø·)              # â­ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ
â”œâ”€â”€ signal_validator.py (29001 Ø®Ø·)         # âœ… Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ
â”œâ”€â”€ multi_tf_aggregator.py (822 Ø®Ø·)        # ğŸ”„ ØªØ±Ú©ÛŒØ¨ TF
â”œâ”€â”€ timeframe_score_cache.py (17775 Ø®Ø·)    # ğŸ’¾ Ú©Ø´
â”‚
â”œâ”€â”€ analyzers/                              # ğŸ“Š 11 ØªØ­Ù„ÛŒÙ„Ú¯Ø± (6535 Ø®Ø·)
â”‚   â”œâ”€â”€ base_analyzer.py (350 Ø®Ø·)
â”‚   â”œâ”€â”€ trend_analyzer.py (548 Ø®Ø·)
â”‚   â”œâ”€â”€ momentum_analyzer.py (1303 Ø®Ø·)
â”‚   â”œâ”€â”€ volume_analyzer.py (596 Ø®Ø·)
â”‚   â”œâ”€â”€ volume_pattern_analyzer.py (583 Ø®Ø·)
â”‚   â”œâ”€â”€ pattern_analyzer.py (464 Ø®Ø·)
â”‚   â”œâ”€â”€ sr_analyzer.py (781 Ø®Ø·)
â”‚   â”œâ”€â”€ volatility_analyzer.py (538 Ø®Ø·)
â”‚   â”œâ”€â”€ harmonic_analyzer.py (495 Ø®Ø·)
â”‚   â”œâ”€â”€ channel_analyzer.py (154 Ø®Ø·)
â”‚   â”œâ”€â”€ cyclical_analyzer.py (371 Ø®Ø·)
â”‚   â””â”€â”€ htf_analyzer.py (323 Ø®Ø·)
â”‚
â”œâ”€â”€ analyzers/indicators/                   # ğŸ“ˆ Ø³ÛŒØ³ØªÙ… Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±Ù‡Ø§
â”‚   â”œâ”€â”€ indicator_orchestrator.py (347 Ø®Ø·)
â”‚   â”œâ”€â”€ base_indicator.py (13694 Ø®Ø·)
â”‚   â””â”€â”€ ema.py, sma.py, rsi.py, macd.py, ... (10 Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±)
â”‚
â”œâ”€â”€ analyzers/patterns/                     # ğŸ•¯ï¸ 35+ Ø§Ù„Ú¯Ùˆ
â”‚   â”œâ”€â”€ pattern_orchestrator.py
â”‚   â”œâ”€â”€ candlestick/ (30+ Ø§Ù„Ú¯ÙˆÛŒ Ú©Ù†Ø¯Ù„ÛŒ)
â”‚   â”‚   â”œâ”€â”€ engulfing.py, hammer.py, doji.py, ...
â”‚   â”‚   â””â”€â”€ morning_star.py, three_white_soldiers.py, ...
â”‚   â””â”€â”€ chart/ (5 Ø§Ù„Ú¯ÙˆÛŒ Ú†Ø§Ø±Øª)
â”‚       â”œâ”€â”€ head_shoulders.py, double_top_bottom.py
â”‚       â””â”€â”€ triangle.py, wedge.py, flag_pennant.py
â”‚
â””â”€â”€ systems/                                # ğŸ§  Ø³ÛŒØ³ØªÙ…â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯
    â”œâ”€â”€ market_regime_detector.py
    â”œâ”€â”€ adaptive_learning_system.py
    â”œâ”€â”€ correlation_manager.py
    â””â”€â”€ emergency_circuit_breaker.py
```

---

## Ø¨Ø®Ø´ Û±: Ù…Ø³ÛŒØ± ÙˆØ±ÙˆØ¯ Ø¯Ø§Ø¯Ù‡ Ùˆ Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„

### 1.1 Ù†Ù‚Ø·Ù‡ Ø´Ø±ÙˆØ¹: Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§

ÙˆÙ‚ØªÛŒ `SignalProcessor` ÛŒÚ© Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø§Ù†ØªØ®Ø§Ø¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø§ÛŒÙ† Ú©Ø§Ø± Ø§Ø² Ù…ØªØ¯ `process_symbol()` Ø´Ø±ÙˆØ¹ Ù…ÛŒâ€ŒØ´ÙˆØ¯:

**Ù…Ø­Ù„:** `signal_processor.py:392-560`

```python
async def process_symbol(self, symbol: str, force_refresh: bool = False, priority: bool = False)
```

Ø§ÛŒÙ† Ù…ØªØ¯:
1. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú†Ù†Ø¯ ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ… Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø§Ø² `MarketDataFetcher`)
2. Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ `SignalOrchestrator.analyze_symbol()` Ø§Ø±Ø³Ø§Ù„ Ù…ÛŒâ€ŒÚ©Ù†Ø¯

### 1.2 ÙˆØ±ÙˆØ¯ Ø¨Ù‡ SignalOrchestrator

**Ù…Ø­Ù„:** `signal_generation/orchestrator.py:872-959`

```python
async def analyze_symbol(
    self,
    symbol: str,
    timeframes_data: Dict[str, Any]
) -> Optional[SignalInfo]:
```

**Ú¯Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ:**

```python
# Ø®Ø· 894-897: ÙÛŒÙ„ØªØ± ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ø¹ØªØ¨Ø±
valid_timeframes = {
    tf: df for tf, df in timeframes_data.items()
    if df is not None and not df.empty
}

# Ø®Ø· 904-906: Ø¨Ø±Ø±Ø³ÛŒ ÙØ¹Ø§Ù„ Ø¨ÙˆØ¯Ù† Multi-TF Aggregation
if not self.use_multi_tf_aggregation:
    return None

# Ø®Ø· 910-933: ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø±Ø§ÛŒ Ù‡Ø± ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ…
for timeframe in valid_timeframes.keys():
    result = await self._generate_signal_with_context(symbol, timeframe)
    # Ø³Ø§Ø®Øª TimeframeSignal Ø¨Ø±Ø§ÛŒ Ù‡Ø± TF

# Ø®Ø· 942-945: ØªØ±Ú©ÛŒØ¨ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ Ø¨Ø§ MultiTimeframeAggregator
aggregated_signal = self.multi_tf_aggregator.aggregate_timeframe_scores(
    symbol=symbol,
    timeframe_signals=timeframe_signals
)
```

**Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…:** Ø§ÛŒÙ† Ù…ØªØ¯ Ø¨Ø±Ø§ÛŒ **Ù‡Ø± ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ…** Ø¨Ù‡ ØµÙˆØ±Øª Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø³ÛŒÚ¯Ù†Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŒ Ø³Ù¾Ø³ Ø¢Ù†â€ŒÙ‡Ø§ Ø±Ø§ ØªØ±Ú©ÛŒØ¨ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.

---

### 1.3 ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¨Ø±Ø§ÛŒ ÛŒÚ© ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ…

**Ù…Ø­Ù„:** `signal_generation/orchestrator.py:261-513`

```python
async def generate_signal_for_symbol(
    self,
    symbol: str,
    timeframe: str
) -> Optional[SignalInfo]:
```

Ø§ÛŒÙ† Ù…ØªØ¯ **7 Ù…Ø±Ø­Ù„Ù‡ Ø§ØµÙ„ÛŒ + 7 Ø²ÛŒØ±Ù…Ø±Ø­Ù„Ù‡** Ø¯Ø§Ø±Ø¯:

#### **Ù…Ø±Ø­Ù„Ù‡ 0: Ø¨Ø±Ø±Ø³ÛŒ Circuit Breaker**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 284-292

```python
if self.circuit_breaker.enabled:
    is_active, reason = self.circuit_breaker.check_if_active()
    if is_active:
        logger.warning(f"ğŸš¨ Circuit breaker active: {reason}")
        return None
```

**Ù‡Ø¯Ù:** Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØªÙˆÙ„ÛŒØ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„ Ø¯Ø± Ø´Ø±Ø§ÛŒØ· Ø§Ø¶Ø·Ø±Ø§Ø±ÛŒ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø¹Ø¯ Ø§Ø² Ø¶Ø±Ø±Ù‡Ø§ÛŒ Ù…ØªÙˆØ§Ù„ÛŒ)

#### **Ù…Ø±Ø­Ù„Ù‡ 1: Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 294-304

```python
df = await self._fetch_market_data(symbol, timeframe)
```

**Ø¬Ø²Ø¦ÛŒØ§Øª:**
- ØªØ¹Ø¯Ø§Ø¯ Ú©Ù†Ø¯Ù„â€ŒÙ‡Ø§: 500 (Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ… Ø§Ø² config)
- Ø­Ø¯Ø§Ù‚Ù„ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²: 200 Ú©Ù†Ø¯Ù„
- Ø³ØªÙˆÙ†â€ŒÙ‡Ø§: open, high, low, close, volume, timestamp

#### **Ù…Ø±Ø­Ù„Ù‡ 1.5: Ø¨Ø±Ø±Ø³ÛŒ Cache**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 306-326

```python
should_recalc, reason = self.tf_score_cache.should_recalculate(
    symbol, timeframe, df
)

if not should_recalc:
    # Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§Ù…ØªÛŒØ§Ø² Ú©Ø´ Ø´Ø¯Ù‡
    cached_signal = self.tf_score_cache.get_cached_score(symbol, timeframe)
    return cached_signal
```

**Ø´Ø±Ø§ÛŒØ· invalidation (Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¬Ø¯Ø¯):**
1. Ú©Ù†Ø¯Ù„ Ø¬Ø¯ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
2. ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØºÛŒÛŒØ± Ú©Ø±Ø¯Ù‡
3. Ú©Ø´ Ù…Ù†Ù‚Ø¶ÛŒ Ø´Ø¯Ù‡ (TTL)
4. Ú©Ø´ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª

**Ù…Ø²ÛŒØª:** Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ø­Ø§Ø³Ø¨Ø§Øª ØªÚ©Ø±Ø§Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ø§Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§

#### **Ù…Ø±Ø­Ù„Ù‡ 2: Ø§ÛŒØ¬Ø§Ø¯ AnalysisContext**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 328-335

```python
context = AnalysisContext(
    symbol=symbol,
    timeframe=timeframe,
    df=df
)
```

**AnalysisContext Ú†ÛŒØ³ØªØŸ**
ÛŒÚ© Ø´ÛŒØ¡ Ù…Ø´ØªØ±Ú© Ú©Ù‡ ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ­Ù„ÛŒÙ„ Ø±Ø§ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
- `df`: DataFrame Ø¨Ø§ OHLCV Ùˆ Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±Ù‡Ø§
- `symbol`: Ù†Ø§Ù… Ù†Ù…Ø§Ø¯
- `timeframe`: ØªØ§ÛŒÙ…â€ŒÙØ±ÛŒÙ… Ø¬Ø§Ø±ÛŒ
- `results`: Ù†ØªØ§ÛŒØ¬ ØªÙ…Ø§Ù… Analyzer Ù‡Ø§
- `metadata`: Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø¶Ø§ÙÛŒ

#### **Ù…Ø±Ø­Ù„Ù‡ 3: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±Ù‡Ø§**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 337-347

```python
success = self._calculate_indicators(context)
```

**Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø± Ø¨Ø®Ø´ 2 ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.**

#### **Ù…Ø±Ø­Ù„Ù‡ 3.5: ØªØ´Ø®ÛŒØµ Ø±Ú˜ÛŒÙ… Ø¨Ø§Ø²Ø§Ø±**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 350-362

```python
if self.regime_detector.enabled:
    regime_info = self.regime_detector.detect_regime(context.df)
    # Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± context Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Analyzer Ù‡Ø§
    context.metadata['regime_info'] = regime_info
```

**Ø±Ú˜ÛŒÙ…â€ŒÙ‡Ø§ÛŒ Ù…Ù…Ú©Ù†:**
- `trending_bullish`: Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ
- `trending_bearish`: Ø±ÙˆÙ†Ø¯ Ù†Ø²ÙˆÙ„ÛŒ
- `ranging`: Ø®Ù†Ø«ÛŒ
- `high_volatility`: Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ù„Ø§
- `low_volatility`: Ù†ÙˆØ³Ø§Ù† Ù¾Ø§ÛŒÛŒÙ†

#### **Ù…Ø±Ø­Ù„Ù‡ 4: Ø§Ø¬Ø±Ø§ÛŒ Analyzers**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 365-379

```python
self._run_analyzers(context)

# Ø¨Ø±Ø±Ø³ÛŒ Analyzer Ù‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ
required = ['trend', 'momentum', 'volume']
missing = [r for r in required if not context.get_result(r)]
if missing:
    return None
```

**Analyzer Ù‡Ø§ÛŒ Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡ (11 Ø¹Ø¯Ø¯):**
1. TrendAnalyzer
2. MomentumAnalyzer
3. VolumeAnalyzer
4. VolumePatternAnalyzer
5. PatternAnalyzer
6. SRAnalyzer
7. VolatilityAnalyzer
8. HarmonicAnalyzer
9. ChannelAnalyzer
10. CyclicalAnalyzer
11. HTFAnalyzer

**Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø± Ø¨Ø®Ø´ 3 ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.**

#### **Ù…Ø±Ø­Ù„Ù‡ 5: ØªØ¹ÛŒÛŒÙ† Ø¬Ù‡Øª**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 381-390

```python
direction = self._determine_direction(context)
# Ù†ØªÛŒØ¬Ù‡: 'LONG', 'SHORT', ÛŒØ§ None
```

**Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… ØªØ¹ÛŒÛŒÙ† Ø¬Ù‡Øª:**
```python
bullish_score = 0
bearish_score = 0

# Trend (ÙˆØ²Ù† 3x)
if trend == 'bullish':
    bullish_score += trend_strength * 3

# Momentum (ÙˆØ²Ù† 2x)
if momentum == 'bullish':
    bullish_score += momentum_strength * 2

# Volume (bonus +1)
if volume_confirmed:
    bullish_score += 1

# Patterns
for pattern in patterns:
    if pattern.direction == 'bullish':
        bullish_score += pattern.score

# ØªØ¹ÛŒÛŒÙ† Ù†Ù‡Ø§ÛŒÛŒ
if bullish_score > bearish_score + threshold:
    direction = 'LONG'
elif bearish_score > bullish_score + threshold:
    direction = 'SHORT'
else:
    direction = None  # Ø³ÛŒÚ¯Ù†Ø§Ù„ ÙˆØ§Ø¶Ø­ÛŒ Ù†ÛŒØ³Øª
```

#### **Ù…Ø±Ø­Ù„Ù‡ 6: Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ù…ØªÛŒØ§Ø²**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 392-412

```python
score = self.signal_scorer.calculate_score(context, direction)
```

**Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§Ù…Ù„ Ø¯Ø± Ø¨Ø®Ø´ 4 ØªÙˆØ¶ÛŒØ­ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.**

Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø³ÛŒØ§Ø± Ù¾ÛŒÚ†ÛŒØ¯Ù‡ Ø§Ø³Øª Ùˆ Ø´Ø§Ù…Ù„:
- Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ Ù¾Ø§ÛŒÙ‡ Ø§Ø² 10 Analyzer
- ÙˆØ²Ù†â€ŒØ¯Ù‡ÛŒ Ø¨Ø§ 10 ÙˆØ²Ù† Ù…Ø®ØªÙ„Ù
- Ù…Ø­Ø§Ø³Ø¨Ù‡ confluence (Ù‡Ù…Ú¯Ø±Ø§ÛŒÛŒ)
- Ø§Ø¹Ù…Ø§Ù„ 13 Ø¶Ø±ÛŒØ¨ (multiplier)

#### **Ù…Ø±Ø­Ù„Ù‡ 7: Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 442-462

```python
is_valid, reason = self.signal_validator.validate(signal, context)

if not is_valid:
    logger.info(f"Signal rejected: {reason}")
    return None
```

**Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø±Ø±Ø³ÛŒ Ø´Ø¯Ù‡:**
1. Ø­Ø¯Ø§Ù‚Ù„ Ø§Ù…ØªÛŒØ§Ø² (min_score)
2. Risk/Reward ratio >= 2.0
3. Ø­Ø¬Ù… Ú©Ø§ÙÛŒ
4. ÙØ§ØµÙ„Ù‡ Ø§Ø² Ø³Ø·ÙˆØ­ SR
5. ØªØ§ÛŒÛŒØ¯ Ú†Ù†Ø¯ Analyzer
6. Ù…Ø­Ø¯ÙˆØ¯ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø²Ù…Ø§Ù†ÛŒ

#### **Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ:**
**Ù…Ø­Ù„:** Ø®Ø·ÙˆØ· 464-489

```python
# Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Cache
self.tf_score_cache.update_cache(symbol, timeframe, signal, df)

# Ø°Ø®ÛŒØ±Ù‡ Context Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨Ø¹Ø¯ÛŒ
cache_key = f"{symbol}:{timeframe}"
self._context_cache[cache_key] = (context, time.time())

# Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ TradeManager (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
if self.send_to_trade_manager:
    await self._send_to_trade_manager(signal)

return signal  # SignalInfo
```

---

**Ø®Ù„Ø§ØµÙ‡ Ø¨Ø®Ø´ 1:**

Ù…Ø³ÛŒØ± ÙˆØ±ÙˆØ¯ Ø¯Ø§Ø¯Ù‡:
```
SignalProcessor.process_symbol()
    â†“
SignalOrchestrator.analyze_symbol() [Ø¨Ø±Ø§ÛŒ Ù‡Ø± TF]
    â†“
    â”œâ”€ generate_signal_for_symbol() â†’ Ø³ÛŒÚ¯Ù†Ø§Ù„ ØªÚ© TF
    â”‚   â”œâ”€ [0] Circuit Breaker Check
    â”‚   â”œâ”€ [1] Fetch Data (500 candles)
    â”‚   â”œâ”€ [1.5] Cache Check
    â”‚   â”œâ”€ [2] Create Context
    â”‚   â”œâ”€ [3] Calculate Indicators (10 indicators)
    â”‚   â”œâ”€ [3.5] Detect Market Regime
    â”‚   â”œâ”€ [4] Run Analyzers (11 analyzers)
    â”‚   â”œâ”€ [5] Determine Direction
    â”‚   â”œâ”€ [6] Calculate Score (13 multipliers)
    â”‚   â””â”€ [7] Validate
    â†“
MultiTimeframeAggregator.aggregate_timeframe_scores()
    â†“
SignalInfo Ù†Ù‡Ø§ÛŒÛŒ (ØªØ±Ú©ÛŒØ¨ Ú†Ù†Ø¯ TF)
```

---

