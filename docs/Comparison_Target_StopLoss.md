# Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¬Ø§Ù…Ø¹ Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Target Ùˆ Stop-Loss

## Ù…Ù‚Ø¯Ù…Ù‡

Ø§ÛŒÙ† Ø³Ù†Ø¯ ÛŒÚ© Ù…Ù‚Ø§ÛŒØ³Ù‡ **Ø¯Ù‚ÛŒÙ‚ Ùˆ Ú©Ø§Ù…Ù„** Ø¨ÛŒÙ† Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Target Ùˆ Stop-Loss Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ… Ùˆ Ø¬Ø¯ÛŒØ¯ Ø§Ø±Ø§Ø¦Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯.

### Ù‡Ø¯Ù

âœ… Ø¨Ø±Ø±Ø³ÛŒ ÙØ±Ù…ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø± Ù‡Ø± Ø³ÛŒØ³ØªÙ…
âœ… Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø±ÙˆÛŒÚ©Ø±Ø¯Ù‡Ø§ Ùˆ Ù…Ù†Ø·Ù‚ Ù¾Ø´Øª Ù‡Ø± Ø±ÙˆØ´
âœ… Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…Ø²Ø§ÛŒØ§ Ùˆ Ù…Ø¹Ø§ÛŒØ¨ Ù‡Ø± Ø±ÙˆØ´
âœ… Ø§Ø±Ø§Ø¦Ù‡ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§

---

## ÙÙ‡Ø±Ø³Øª Ù…Ø·Ø§Ù„Ø¨

1. [Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú©Ù„ÛŒ Ø±ÙˆÛŒÚ©Ø±Ø¯Ù‡Ø§](#section-1)
2. [Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…: Ù…Ø­Ø§Ø³Ø¨Ù‡ Stop-Loss](#section-2)
3. [Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…: Ù…Ø­Ø§Ø³Ø¨Ù‡ Take-Profit](#section-3)
4. [Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯: Ù…Ø­Ø§Ø³Ø¨Ù‡ Stop-Loss](#section-4)
5. [Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯: Ù…Ø­Ø§Ø³Ø¨Ù‡ Take-Profit](#section-5)
6. [Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¬Ø¯ÙˆÙ„â€ŒÙˆØ§Ø±](#section-6)
7. [Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ](#section-7)
8. [Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ](#section-8)

---

<a name="section-1"></a>
## Ø¨Ø®Ø´ Û±: Ù…Ù‚Ø§ÛŒØ³Ù‡ Ú©Ù„ÛŒ Ø±ÙˆÛŒÚ©Ø±Ø¯Ù‡Ø§

### 1.1 Ù†Ù…Ø§ÛŒ Ú©Ù„ÛŒ

| Ø¬Ù†Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ (OLD) | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ (NEW) |
|------|------------------|------------------|
| **Ø±ÙˆÛŒÚ©Ø±Ø¯ Ú©Ù„ÛŒ** | Pattern-Based + Fallback | ATR-Based + SR Enhancement |
| **Ø§ÙˆÙ„ÙˆÛŒØª SL** | 1. Pattern, 2. S/R, 3. ATR, 4. % | 1. ATR Ã— Volatility, 2. S/R (optional) |
| **Ø§ÙˆÙ„ÙˆÛŒØª TP** | 1. Pattern, 2. S/R, 3. RR-based | 1. RR-based (2.0), 2. S/R (enhancement) |
| **RR Ù¾ÛŒØ´â€ŒÙØ±Ø¶** | Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ… (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 2.0) | Ø«Ø§Ø¨Øª 2.0 |
| **Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ** | Ø¨Ø§Ù„Ø§ (5 Ø±ÙˆØ´ SL) | Ù…ØªÙˆØ³Ø· (1 Ø±ÙˆØ´ Ø§ØµÙ„ÛŒ + enhancement) |
| **Safety Checks** | 6 Ø¨Ø±Ø±Ø³ÛŒ | 2 Ø¨Ø±Ø±Ø³ÛŒ (Ø¯Ø± SignalInfo) |

### 1.2 ÙÙ„Ø³ÙÙ‡ Ø·Ø±Ø§Ø­ÛŒ

#### Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ:
```
ğŸ¯ Pattern-First Approach
â†’ Ù‡Ø± pattern Ø®ÙˆØ¯Ø´ SL/TP Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ§Ø´ Ø±Ø§ ØªØ¹ÛŒÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø¯
â†’ Ø§Ú¯Ø± pattern Ù†Ø¨ÙˆØ¯ â†’ S/R Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
â†’ Ø§Ú¯Ø± S/R Ù†Ø¨ÙˆØ¯ ÛŒØ§ Ø®ÛŒÙ„ÛŒ Ø¯ÙˆØ± Ø¨ÙˆØ¯ â†’ ATR
â†’ Ø§Ú¯Ø± Ù‡Ù…Ù‡ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯ â†’ % Ø«Ø§Ø¨Øª (fallback Ù†Ù‡Ø§ÛŒÛŒ)

âœ… Ù…Ø²Ø§ÛŒØ§: Ø¯Ù‚ÛŒÙ‚â€ŒØªØ± Ø¨Ø±Ø§ÛŒ patterns Ø®Ø§Øµ
âŒ Ù…Ø¹Ø§ÛŒØ¨: Ù¾ÛŒÚ†ÛŒØ¯Ù‡ØŒ Ø§Ø­ØªÙ…Ø§Ù„ Ø®Ø·Ø§ Ø¨ÛŒØ´ØªØ±
```

#### Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:
```
ğŸ¯ Volatility-First Approach
â†’ Ù‡Ù…ÛŒØ´Ù‡ Ø§Ø² ATR Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ (Ø¨Ø§ ØªÙˆØ¬Ù‡ Ø¨Ù‡ volatility regime)
â†’ S/R ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ TP Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
â†’ RR Ø«Ø§Ø¨Øª 2.0

âœ… Ù…Ø²Ø§ÛŒØ§: Ø³Ø§Ø¯Ù‡ØŒ Ø«Ø§Ø¨ØªØŒ Ù‚Ø§Ø¨Ù„ Ø§Ø¹ØªÙ…Ø§Ø¯
âŒ Ù…Ø¹Ø§ÛŒØ¨: Ú©Ù…ØªØ± Ø¨Ù‡ context Ù‡Ø§ÛŒ Ø®Ø§Øµ ØªÙˆØ¬Ù‡ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
```

---

<a name="section-2"></a>
## Ø¨Ø®Ø´ Û²: Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ… - Ù…Ø­Ø§Ø³Ø¨Ù‡ Stop-Loss

### 2.1 Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ú©Ø§Ù…Ù„ (5 Ø±ÙˆØ´)

**Ù…Ø­Ù„:** `signal_generator.py:4029-4269`

```
[1] Harmonic Pattern
     â†“ (Ø§Ú¯Ø± Ù†Ø¨ÙˆØ¯)
[2] Price Channel
     â†“ (Ø§Ú¯Ø± Ù†Ø¨ÙˆØ¯)
[3] Support/Resistance
     â†“ (Ø§Ú¯Ø± Ù†Ø¨ÙˆØ¯ ÛŒØ§ > 3Ã—ATR Ø¯ÙˆØ± Ø¨ÙˆØ¯)
[4] ATR-based
     â†“ (Ø§Ú¯Ø± ATR Ù†Ø¨ÙˆØ¯)
[5] Percentage-based (Fallback)
```

### 2.2 Ø±ÙˆØ´ Û±: Harmonic Pattern Stop-Loss

```python
# signal_generator.py:4074-4089
if direction == 'long':
    stop_loss = d_point_price * 0.99  # 1% Ø²ÛŒØ± Ù†Ù‚Ø·Ù‡ D
else:
    stop_loss = d_point_price * 1.01  # 1% Ø¨Ø§Ù„Ø§ÛŒ Ù†Ù‚Ø·Ù‡ D
```

**Ù…Ù†Ø·Ù‚:**
- Ù†Ù‚Ø·Ù‡ D Ù†Ù‚Ø·Ù‡ Ú©Ø§Ù…Ù„ Ø´Ø¯Ù† pattern Ø§Ø³Øª
- Ø§Ú¯Ø± Ù‚ÛŒÙ…Øª Ø§Ø² D Ø¹Ø¨ÙˆØ± Ú©Ù†Ø¯ = pattern Ø´Ú©Ø³Øª
- Buffer 1% Ø¨Ø±Ø§ÛŒ noise

**Ù…Ø«Ø§Ù„ (Bullish Gartley):**
```
D Point Price = 50,000
SL = 50,000 Ã— 0.99 = 49,500
```

### 2.3 Ø±ÙˆØ´ Û²: Price Channel Stop-Loss

```python
# signal_generator.py:4101-4123
if direction == 'long':
    stop_loss = lower_channel_line * 0.99
else:
    stop_loss = upper_channel_line * 1.01
```

**Ù…Ù†Ø·Ù‚:**
- Ú©Ø§Ù†Ø§Ù„ = Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø­Ø±Ú©Øª Ù‚ÛŒÙ…Øª
- Ø´Ú©Ø³Øª Ú©Ø§Ù†Ø§Ù„ = ØªØºÛŒÛŒØ± Ø¬Ù‡Øª Ø§Ø­ØªÙ…Ø§Ù„ÛŒ
- Buffer 1%

**Ù…Ø«Ø§Ù„:**
```
Lower Channel = 49,800
SL = 49,800 Ã— 0.99 = 49,302
```

### 2.4 Ø±ÙˆØ´ Û³: Support/Resistance Stop-Loss

```python
# signal_generator.py:4126-4138
if direction == 'long' and nearest_support and nearest_support < current_price:
    stop_loss = nearest_support * 0.999  # 0.1% Ø²ÛŒØ± support
elif direction == 'short' and nearest_resist and nearest_resist > current_price:
    stop_loss = nearest_resist * 1.001  # 0.1% Ø¨Ø§Ù„Ø§ÛŒ resistance
```

**Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¶Ø§ÙÛŒ: ÙØ§ØµÙ„Ù‡ Ø§Ø² S/R Ù†Ø¨Ø§ÛŒØ¯ > 3Ã—ATR Ø¨Ø§Ø´Ø¯**

```python
# signal_generator.py:4140-4146
if stop_loss is not None and atr > 0:
    sl_dist_atr_ratio = abs(current_price - stop_loss) / atr
    if sl_dist_atr_ratio > 3.0:
        stop_loss = None  # Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ØŒ Ø¨Ù‡ Ø±ÙˆØ´ Ø¨Ø¹Ø¯ÛŒ Ù…ÛŒâ€ŒØ±ÙˆÛŒÙ…
```

**Ù…Ù†Ø·Ù‚:**
- S/R Ø³Ø·ÙˆØ­ Ù‚ÙˆÛŒ Ù‚ÛŒÙ…ØªÛŒ Ù‡Ø³ØªÙ†Ø¯
- Ù‚ÛŒÙ…Øª Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ Ø§Ø² S/R ÙˆØ§Ú©Ù†Ø´ Ù†Ø´Ø§Ù† Ù…ÛŒâ€ŒØ¯Ù‡Ø¯
- Ø§Ú¯Ø± Ø®ÛŒÙ„ÛŒ Ø¯ÙˆØ± Ø¨Ø§Ø´Ø¯ (> 3Ã—ATR) = ØºÛŒØ±Ø¹Ù…Ù„ÛŒ

**Ù…Ø«Ø§Ù„:**
```
Current Price = 50,000
Nearest Support = 49,500
ATR = 300

Distance = 50,000 - 49,500 = 500
Ratio = 500 / 300 = 1.67 < 3.0 âœ… Ù‚Ø¨ÙˆÙ„

SL = 49,500 Ã— 0.999 = 49,450.5
```

### 2.5 Ø±ÙˆØ´ Û´: ATR-based Stop-Loss

```python
# signal_generator.py:4148-4155
if stop_loss is None and atr > 0:
    sl_multiplier = adapted_risk_config.get('atr_trailing_multiplier', 2.0)

    if direction == 'long':
        stop_loss = current_price - (atr * sl_multiplier)
    else:
        stop_loss = current_price + (atr * sl_multiplier)
```

**Ù…Ù†Ø·Ù‚:**
- ATR = Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ù…Ø­Ø¯ÙˆØ¯Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ (Ù†ÙˆØ³Ø§Ù†)
- 2Ã—ATR = ÙØ¶Ø§ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ noise
- Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ… ØªÙˆØ³Ø· Adaptive Learning

**Ù…Ø«Ø§Ù„:**
```
Current Price = 50,000
ATR = 300
Multiplier = 2.0

SL = 50,000 - (300 Ã— 2.0) = 49,400
```

### 2.6 Ø±ÙˆØ´ Ûµ: Percentage-based (Fallback)

```python
# signal_generator.py:4157-4163
default_sl_percent = adapted_risk_config.get('default_stop_loss_percent', 1.5)

if direction == 'long':
    stop_loss = current_price * (1 - default_sl_percent/100)
else:
    stop_loss = current_price * (1 + default_sl_percent/100)
```

**Ù…Ù†Ø·Ù‚:**
- Ø¢Ø®Ø±ÛŒÙ† Ø±Ø§Ù‡ (Ø§Ú¯Ø± Ù‡Ù…Ù‡ Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø´Ú©Ø³Øª Ø®ÙˆØ±Ø¯Ù†Ø¯)
- Ø«Ø§Ø¨Øª Ùˆ Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ
- Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 1.5%

**Ù…Ø«Ø§Ù„:**
```
Current Price = 50,000
SL% = 1.5%

SL = 50,000 Ã— (1 - 0.015) = 49,250
```

### 2.7 Safety Checks Ø¨Ø±Ø§ÛŒ Stop-Loss

#### Check 1: Ø­Ø¯Ø§Ù‚Ù„ ÙØ§ØµÙ„Ù‡

```python
# signal_generator.py:4165-4174
min_sl_distance = atr * 0.5 if atr > 0 else current_price * 0.001

if direction == 'long' and (current_price - stop_loss) < min_sl_distance:
    stop_loss = current_price - min_sl_distance
```

**Ú†Ø±Ø§ØŸ**
- SL Ø®ÛŒÙ„ÛŒ Ù†Ø²Ø¯ÛŒÚ© = Ø§Ø­ØªÙ…Ø§Ù„ Hit Ø´Ø¯Ù† Ø¨Ù‡ Ø®Ø§Ø·Ø± noise
- Ø­Ø¯Ø§Ù‚Ù„: 0.5Ã—ATR ÛŒØ§ 0.1%

#### Check 2: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØµÙØ±

```python
# signal_generator.py:4176-4185
risk_distance = abs(current_price - stop_loss)
if risk_distance <= 1e-6:
    risk_distance = current_price * (default_sl_percent / 100)
    stop_loss = current_price - risk_distance  # ÛŒØ§ +
```

#### Check 3: Precision

```python
# signal_generator.py:4238-4245
precision = 8  # 8 Ø±Ù‚Ù… Ø§Ø¹Ø´Ø§Ø±
stop_loss = round(stop_loss, precision)
```

---

<a name="section-3"></a>
## Ø¨Ø®Ø´ Û³: Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ… - Ù…Ø­Ø§Ø³Ø¨Ù‡ Take-Profit

### 3.1 Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ… Ú©Ø§Ù…Ù„

```python
# signal_generator.py:4187-4211

if take_profit is None:  # Ø§Ú¯Ø± Ø§Ø² Pattern Ù†ÛŒØ§Ù…Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
    # Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¨Ø± Ø§Ø³Ø§Ø³ RR
    risk_distance = abs(current_price - stop_loss)
    reward_distance = risk_distance * preferred_rr  # Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 2.0

    if direction == 'long':
        take_profit = current_price + reward_distance
    else:
        take_profit = current_price - reward_distance
```

### 3.2 ØªÙ†Ø¸ÛŒÙ… TP Ø¨Ø± Ø§Ø³Ø§Ø³ S/R

```python
# signal_generator.py:4197-4211

if direction == 'long' and nearest_resist and nearest_resist < take_profit:
    # ÙÙ‚Ø· Ø§Ú¯Ø± Ù‡Ù†ÙˆØ² RR Ø­Ø¯Ø§Ù‚Ù„ÛŒ Ø±Ø§ Ø¨Ø±Ø¢ÙˆØ±Ø¯Ù‡ Ú©Ù†Ø¯
    if nearest_resist > current_price + (risk_distance * min_rr):
        take_profit = nearest_resist * 0.999
```

**Ù…Ù†Ø·Ù‚:**
- Ø§Ú¯Ø± resistance Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ø§Ø² TP Ù…Ø­Ø§Ø³Ø¨Ù‡â€ŒØ´Ø¯Ù‡ Ø¨Ø§Ø´Ø¯
- Ùˆ Ù‡Ù†ÙˆØ² RR Ø­Ø¯Ø§Ù‚Ù„ÛŒ (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 1.5) Ø±Ø§ Ø¨Ø±Ø¢ÙˆØ±Ø¯Ù‡ Ú©Ù†Ø¯
- TP Ø±Ø§ Ø±ÙˆÛŒ resistance Ù‚Ø±Ø§Ø± Ø¨Ø¯Ù‡ (Ø¨Ø§ 0.1% buffer)

**Ù…Ø«Ø§Ù„:**
```
Current Price = 50,000
Risk = 600 (SL = 49,400)
Preferred RR = 2.0
Min RR = 1.5

Calculated TP = 50,000 + (600 Ã— 2.0) = 51,200
Nearest Resistance = 50,800

Check: 50,800 > 50,000 + (600 Ã— 1.5) = 50,900? NO
â†’ TP = 51,200 (Ù…Ù‚Ø§ÙˆÙ…Øª Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ú†ÙˆÙ† RR Ø±Ø§ Ù¾Ø§ÛŒÛŒÙ† Ù…ÛŒâ€ŒØ¢ÙˆØ±Ø¯)
```

### 3.3 Safety Checks Ø¨Ø±Ø§ÛŒ Take-Profit

#### Check 1: Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² RR Ø­Ø¯Ø§Ù‚Ù„ÛŒ

```python
# signal_generator.py:4213-4223
if direction == 'long' and take_profit <= current_price + (risk_distance * min_rr * 0.9):
    take_profit = current_price + (risk_distance * min_rr)
```

#### Check 2: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² ØµÙØ±

```python
# signal_generator.py:4229-4236
if abs(take_profit) < 1e-6:
    take_profit = current_price * (1.05 if direction == 'long' else 0.95)
```

### 3.4 Ù…Ø­Ø§Ø³Ø¨Ù‡ RR Ù†Ù‡Ø§ÛŒÛŒ

```python
# signal_generator.py:4246-4252
final_rr = abs(take_profit - current_price) / abs(current_price - stop_loss)

return {
    'stop_loss': round(stop_loss, 8),
    'take_profit': round(take_profit, 8),
    'risk_reward_ratio': round(final_rr, 2),
    'risk_amount_per_unit': round(risk_distance, 8),
    'sl_method': calculation_method
}
```

---

<a name="section-4"></a>
## Ø¨Ø®Ø´ Û´: Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ - Ù…Ø­Ø§Ø³Ø¨Ù‡ Stop-Loss

### 4.1 Ø±ÙˆÛŒÚ©Ø±Ø¯ Ø³Ø§Ø¯Ù‡ Ùˆ Ø«Ø§Ø¨Øª

**Ù…Ø­Ù„:** `signal_generation/orchestrator.py:635-693`

```python
# Get volatility
volatility_result = context.get_result('volatility')
atr = volatility_result.get('atr_value')
stop_atr_mult = volatility_result.get('recommended_stop_atr', 2.0)

# Calculate stop distance
stop_distance = atr * stop_atr_mult

# Apply based on direction
if direction == 'LONG':
    stop_loss = entry - stop_distance
else:
    stop_loss = entry + stop_distance
```

### 4.2 ØªØ¹ÛŒÛŒÙ† ATR Multiplier Ø¨Ø± Ø§Ø³Ø§Ø³ Volatility Regime

**Ù…Ø­Ù„:** `signal_generation/analyzers/volatility_analyzer.py:422-453`

```python
def _calculate_recommended_stop(
    volatility_regime: str,
    current_atr: float,
    timeframe: str = None
) -> float:
    # Base ATR multiples for different regimes
    base_stops = {
        'low': 1.5,      # Tighter stops in low volatility
        'normal': 2.0,   # Standard stops
        'high': 3.0      # Wider stops in high volatility
    }

    default_stop = base_stops.get(volatility_regime, 2.0)
    return default_stop
```

**Ù…Ù†Ø·Ù‚:**
- Ù†ÙˆØ³Ø§Ù† Ù¾Ø§ÛŒÛŒÙ† â†’ SL Ù…Ø­Ú©Ù…â€ŒØªØ± (1.5Ã—ATR)
- Ù†ÙˆØ³Ø§Ù† Ø¹Ø§Ø¯ÛŒ â†’ SL Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ (2.0Ã—ATR)
- Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ù„Ø§ â†’ SL Ú¯Ø³ØªØ±Ø¯Ù‡â€ŒØªØ± (3.0Ã—ATR)

### 4.3 Ù…Ø«Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡

```
Current Price = 50,000
ATR = 300
Volatility Regime = 'normal'
â†’ ATR Multiplier = 2.0

Stop Distance = 300 Ã— 2.0 = 600
SL (LONG) = 50,000 - 600 = 49,400
```

### 4.4 Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…

| Ø¬Ù†Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ |
|------|------------|------------|
| **ØªØ¹Ø¯Ø§Ø¯ Ø±ÙˆØ´** | 5 Ø±ÙˆØ´ (Pattern, Channel, S/R, ATR, %) | 1 Ø±ÙˆØ´ (ATR-based) |
| **Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ** | Ø¨Ø§Ù„Ø§ | Ù¾Ø§ÛŒÛŒÙ† |
| **Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ** | Ù…ØªÙˆØ³Ø· | Ø¨Ø§Ù„Ø§ |
| **Context-Aware** | Ø¨Ù„Ù‡ (pattern-specific) | Ø¨Ù„Ù‡ (volatility-aware) |
| **Fallback** | Ø¨Ù„Ù‡ (5 Ø³Ø·Ø­) | Ø®ÛŒØ± (Ù‡Ù…ÛŒØ´Ù‡ ATR) |

---

<a name="section-5"></a>
## Ø¨Ø®Ø´ Ûµ: Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ - Ù…Ø­Ø§Ø³Ø¨Ù‡ Take-Profit

### 5.1 RR Ø«Ø§Ø¨Øª 2.0

```python
# orchestrator.py:663-693

if direction == 'LONG':
    entry = current_price
    stop_loss = entry - stop_distance
    default_tp = entry + (stop_distance * 2)  # RR = 2.0
```

**Ù…Ù†Ø·Ù‚:**
- Ø³Ø§Ø¯Ù‡ Ùˆ Ø«Ø§Ø¨Øª
- RR Ù‡Ù…ÛŒØ´Ù‡ 2:1
- Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ

### 5.2 Enhancement Ø¨Ø§ S/R (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)

```python
# orchestrator.py:668-677

if sr_result and sr_result.get('nearest_resistance'):
    sr_tp = sr_result['nearest_resistance']

    # Check: SR must be above entry AND provide better RR than default
    if sr_tp > entry and (sr_tp - entry) >= (default_tp - entry) * 0.8:
        take_profit = sr_tp
    else:
        take_profit = default_tp
```

**Ù…Ù†Ø·Ù‚:**
- Ø§Ú¯Ø± Ù…Ù‚Ø§ÙˆÙ…Øª Ù†Ø²Ø¯ÛŒÚ© ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯
- Ùˆ Ø­Ø¯Ø§Ù‚Ù„ 80% RR Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø±Ø§ Ø­ÙØ¸ Ù…ÛŒâ€ŒÚ©Ù†Ø¯
- TP Ø±Ø§ Ø±ÙˆÛŒ Ù…Ù‚Ø§ÙˆÙ…Øª Ù‚Ø±Ø§Ø± Ø¨Ø¯Ù‡

**Ù…Ø«Ø§Ù„:**
```
Entry = 50,000
Stop Distance = 600
Default TP = 50,000 + (600 Ã— 2) = 51,200

Nearest Resistance = 50,900

Check:
1. 50,900 > 50,000? âœ…
2. (50,900 - 50,000) >= (51,200 - 50,000) Ã— 0.8?
   900 >= 1,200 Ã— 0.8?
   900 >= 960? âŒ

â†’ TP = 51,200 (default) - Ù…Ù‚Ø§ÙˆÙ…Øª Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯
```

### 5.3 Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¨Ø§ Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…

| Ø¬Ù†Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ |
|------|------------|------------|
| **RR Ù¾ÛŒØ´â€ŒÙØ±Ø¶** | Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ… (Ù…Ø¹Ù…ÙˆÙ„Ø§Ù‹ 2.0) | Ø«Ø§Ø¨Øª 2.0 |
| **Pattern-based TP** | Ø¨Ù„Ù‡ (Harmonic, H&S, etc.) | Ø®ÛŒØ± |
| **S/R Enhancement** | Ø¨Ù„Ù‡ (Ø¨Ø§ min RR check) | Ø¨Ù„Ù‡ (Ø¨Ø§ 80% RR check) |
| **Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ** | Ù…ØªÙˆØ³Ø· | Ù¾Ø§ÛŒÛŒÙ† |

---

<a name="section-6"></a>
## Ø¨Ø®Ø´ Û¶: Ù…Ù‚Ø§ÛŒØ³Ù‡ Ø¬Ø¯ÙˆÙ„â€ŒÙˆØ§Ø± Ú©Ø§Ù…Ù„

### 6.1 Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡ Stop-Loss

| Ø±ÙˆØ´ Ù…Ø­Ø§Ø³Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ | Ø¨Ø±Ù†Ø¯Ù‡ |
|-----------|------------|------------|-------|
| **Harmonic Pattern** | âœ… D Point Â± 1% | âŒ Ù†Ø¯Ø§Ø±Ø¯ | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **Price Channel** | âœ… Channel Line Â± 1% | âŒ Ù†Ø¯Ø§Ø±Ø¯ | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **Support/Resistance** | âœ… S/R Â± 0.1% (if < 3Ã—ATR) | âŒ Ù†Ø¯Ø§Ø±Ø¯ (ÙÙ‚Ø· Ø¯Ø± TP) | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **ATR-based** | âœ… ATR Ã— 2.0 (fallback) | âœ… ATR Ã— (1.5-3.0) Ø¨Ø± Ø§Ø³Ø§Ø³ regime | **Ø¬Ø¯ÛŒØ¯** |
| **Percentage** | âœ… 1.5% (fallback) | âŒ Ù†Ø¯Ø§Ø±Ø¯ | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **Volatility-Aware** | âŒ ÙÙ‚Ø· Ø¯Ø± ØªÙ†Ø¸ÛŒÙ… ATR multiplier | âœ… Regime-based multiplier | **Ø¬Ø¯ÛŒØ¯** |
| **Safety Checks** | âœ… 6 Ø¨Ø±Ø±Ø³ÛŒ | âœ… 2 Ø¨Ø±Ø±Ø³ÛŒ (Ø¯Ø± SignalInfo) | Ù‚Ø¯ÛŒÙ…ÛŒ |

### 6.2 Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§ÛŒØ³Ù‡ Take-Profit

| Ø±ÙˆØ´ Ù…Ø­Ø§Ø³Ø¨Ù‡ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ | Ø¨Ø±Ù†Ø¯Ù‡ |
|-----------|------------|------------|-------|
| **RR-based** | âœ… RR Ã— Risk (Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…) | âœ… 2.0 Ã— Risk (Ø«Ø§Ø¨Øª) | Ø¨Ø±Ø§Ø¨Ø± |
| **Pattern-based** | âœ… Fibonacci, Height, etc. | âŒ Ù†Ø¯Ø§Ø±Ø¯ | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **S/R Enhancement** | âœ… Ø¨Ø§ min RR check | âœ… Ø¨Ø§ 80% RR check | Ø¨Ø±Ø§Ø¨Ø± |
| **Flexibility** | Ø¨Ø§Ù„Ø§ (RR Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…) | Ù¾Ø§ÛŒÛŒÙ† (RR Ø«Ø§Ø¨Øª) | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **Simplicity** | Ù…ØªÙˆØ³Ø· | Ø¨Ø§Ù„Ø§ | **Ø¬Ø¯ÛŒØ¯** |

### 6.3 ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ú©Ù„ÛŒ

| ÙˆÛŒÚ˜Ú¯ÛŒ | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ | Ø¨Ø±Ù†Ø¯Ù‡ |
|-------|------------|------------|-------|
| **ØªØ¹Ø¯Ø§Ø¯ Ø±ÙˆØ´ SL** | 5 | 1 | Ø¬Ø¯ÛŒØ¯ (Ø³Ø§Ø¯Ú¯ÛŒ) |
| **Context-Awareness** | Ø¨Ø§Ù„Ø§ (Pattern, S/R, ATR) | Ù…ØªÙˆØ³Ø· (Volatility) | Ù‚Ø¯ÛŒÙ…ÛŒ |
| **Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ** | Ù…ØªÙˆØ³Ø· | Ø¨Ø§Ù„Ø§ | **Ø¬Ø¯ÛŒØ¯** |
| **Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ Ú©Ø¯** | Ø¨Ø§Ù„Ø§ (~240 Ø®Ø·) | Ù¾Ø§ÛŒÛŒÙ† (~60 Ø®Ø·) | **Ø¬Ø¯ÛŒØ¯** |
| **Ø§Ø­ØªÙ…Ø§Ù„ Ø®Ø·Ø§** | Ù…ØªÙˆØ³Ø· | Ù¾Ø§ÛŒÛŒÙ† | **Ø¬Ø¯ÛŒØ¯** |
| **Adaptive** | Ø¨Ù„Ù‡ (Learning System) | Ø¨Ù„Ù‡ (Volatility Regime) | Ø¨Ø±Ø§Ø¨Ø± |
| **Safety** | Ø¹Ø§Ù„ÛŒ (6 check) | Ø®ÙˆØ¨ (2 check) | Ù‚Ø¯ÛŒÙ…ÛŒ |

---

<a name="section-7"></a>
## Ø¨Ø®Ø´ Û·: Ù…Ø«Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒ

### 7.1 Ø³Ù†Ø§Ø±ÛŒÙˆ Û±: Ø³ÛŒÚ¯Ù†Ø§Ù„ LONG Ø³Ø§Ø¯Ù‡ (Ø¨Ø¯ÙˆÙ† Pattern)

#### Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ:

```python
Current Price = 50,000
ATR = 300
Nearest Support = 49,500
Nearest Resistance = 51,000

# Stop-Loss
# Ø±ÙˆØ´ 1 (Harmonic): N/A
# Ø±ÙˆØ´ 2 (Channel): N/A
# Ø±ÙˆØ´ 3 (S/R): Support = 49,500
Distance = 50,000 - 49,500 = 500
Ratio = 500 / 300 = 1.67 < 3.0 âœ…
SL = 49,500 Ã— 0.999 = 49,450.5

# Take-Profit
Risk = 50,000 - 49,450.5 = 549.5
RR = 2.0
Reward = 549.5 Ã— 2.0 = 1,099
TP (default) = 50,000 + 1,099 = 51,099

# S/R Check
Resistance = 51,000
51,000 > 50,000 + (549.5 Ã— 1.5)? â†’ 51,000 > 50,824.25? âœ…
TP (final) = 51,000 Ã— 0.999 = 50,949

RR Ù†Ù‡Ø§ÛŒÛŒ = (50,949 - 50,000) / 549.5 = 1.73
```

#### Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

```python
Current Price = 50,000
ATR = 300
Volatility Regime = 'normal'
â†’ ATR Multiplier = 2.0

# Stop-Loss
Stop Distance = 300 Ã— 2.0 = 600
SL = 50,000 - 600 = 49,400

# Take-Profit
Default TP = 50,000 + (600 Ã— 2.0) = 51,200

# S/R Check
Resistance = 51,000
51,000 > 50,000? âœ…
(51,000 - 50,000) >= (51,200 - 50,000) Ã— 0.8?
1,000 >= 960? âœ…
TP (final) = 51,000

RR Ù†Ù‡Ø§ÛŒÛŒ = (51,000 - 50,000) / 600 = 1.67
```

**Ù…Ù‚Ø§ÛŒØ³Ù‡:**
- SL Ù‚Ø¯ÛŒÙ…ÛŒ: 49,450.5 (Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ø¨Ù‡ S/R)
- SL Ø¬Ø¯ÛŒØ¯: 49,400 (Ù…Ø­Ø§ÙØ¸Ù‡â€ŒÚ©Ø§Ø±Ø§Ù†Ù‡â€ŒØªØ± - ATR-based)
- TP Ù‚Ø¯ÛŒÙ…ÛŒ: 50,949
- TP Ø¬Ø¯ÛŒØ¯: 51,000
- RR Ù‚Ø¯ÛŒÙ…ÛŒ: 1.73
- RR Ø¬Ø¯ÛŒØ¯: 1.67

### 7.2 Ø³Ù†Ø§Ø±ÛŒÙˆ Û²: Bullish Gartley Pattern

#### Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ:

```python
D Point = 50,000
X Point = 52,000
Current Price = 50,100

# Stop-Loss (Pattern-based)
SL = 50,000 Ã— 0.99 = 49,500

# Take-Profit (Pattern-based Ø¨Ø§ Fibonacci)
Risk = 50,100 - 49,500 = 600
TP = 50,100 + (600 Ã— 1.618) = 51,070.8

RR = 1.62
```

#### Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

```python
Current Price = 50,100
ATR = 300
Volatility = 'normal'

# Stop-Loss (ATR-based - pattern ignored!)
SL = 50,100 - (300 Ã— 2.0) = 49,500

# Take-Profit (RR 2.0)
TP = 50,100 + (600 Ã— 2.0) = 51,300

RR = 2.00
```

**Ù…Ù‚Ø§ÛŒØ³Ù‡:**
- SL: ÛŒÚ©Ø³Ø§Ù† (ØªØµØ§Ø¯ÙØ§Ù‹!)
- TP Ù‚Ø¯ÛŒÙ…ÛŒ: 51,070.8 (Pattern-specific Fibonacci)
- TP Ø¬Ø¯ÛŒØ¯: 51,300 (RR Ø«Ø§Ø¨Øª)
- RR Ù‚Ø¯ÛŒÙ…ÛŒ: 1.62 (Fibonacci-based)
- RR Ø¬Ø¯ÛŒØ¯: 2.00 (Ø«Ø§Ø¨Øª)

**âš ï¸ Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…:** Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Pattern Ø±Ø§ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯!

### 7.3 Ø³Ù†Ø§Ø±ÛŒÙˆ Û³: Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ù„Ø§

#### Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ:

```python
Current Price = 50,000
ATR = 800 (Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ù„Ø§!)
Support = 48,500

# Stop-Loss
# S/R Check:
Distance = 50,000 - 48,500 = 1,500
Ratio = 1,500 / 800 = 1.875 < 3.0 âœ…
SL = 48,500 Ã— 0.999 = 48,451.5

# Take-Profit
Risk = 1,548.5
TP = 50,000 + (1,548.5 Ã— 2.0) = 53,097

RR = 2.00
```

#### Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

```python
Current Price = 50,000
ATR = 800
Volatility Regime = 'high'
â†’ ATR Multiplier = 3.0

# Stop-Loss
Stop Distance = 800 Ã— 3.0 = 2,400
SL = 50,000 - 2,400 = 47,600

# Take-Profit
TP = 50,000 + (2,400 Ã— 2.0) = 54,800

RR = 2.00
```

**Ù…Ù‚Ø§ÛŒØ³Ù‡:**
- SL Ù‚Ø¯ÛŒÙ…ÛŒ: 48,451.5 (S/R-based)
- SL Ø¬Ø¯ÛŒØ¯: 47,600 (Ú¯Ø³ØªØ±Ø¯Ù‡â€ŒØªØ± - ATR Ã— 3.0)
- TP Ù‚Ø¯ÛŒÙ…ÛŒ: 53,097
- TP Ø¬Ø¯ÛŒØ¯: 54,800
- Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ Ø¯Ø± Ù†ÙˆØ³Ø§Ù† Ø¨Ø§Ù„Ø§ **Ù…Ø­Ø§ÙØ¸Ù‡â€ŒÚ©Ø§Ø±Ø§Ù†Ù‡â€ŒØªØ±** Ø§Ø³Øª

---

<a name="section-8"></a>
## Ø¨Ø®Ø´ Û¸: Ù†ØªÛŒØ¬Ù‡â€ŒÚ¯ÛŒØ±ÛŒ Ùˆ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§

### 8.1 Ù†Ù‚Ø§Ø· Ù‚ÙˆØª Ùˆ Ø¶Ø¹Ù

#### Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ:

âœ… **Ù†Ù‚Ø§Ø· Ù‚ÙˆØª:**
1. Context-Aware (Pattern, S/R, Volatility)
2. Ø¯Ù‚Øª Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø§ÛŒ patterns Ø®Ø§Øµ
3. Fallback Ù…Ø­Ú©Ù… (5 Ø³Ø·Ø­)
4. Safety checks Ø¹Ø§Ù„ÛŒ (6 Ø¨Ø±Ø±Ø³ÛŒ)
5. RR Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…

âŒ **Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù:**
1. Ù¾ÛŒÚ†ÛŒØ¯Ú¯ÛŒ Ø¨Ø§Ù„Ø§
2. Ø§Ø­ØªÙ…Ø§Ù„ Ø®Ø·Ø§ Ø¨ÛŒØ´ØªØ±
3. Ø³Ø®Øª Ø¨Ø±Ø§ÛŒ debug
4. Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ú©Ù…ØªØ±

#### Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

âœ… **Ù†Ù‚Ø§Ø· Ù‚ÙˆØª:**
1. Ø³Ø§Ø¯Ù‡ Ùˆ ÙˆØ§Ø¶Ø­
2. Ù‚Ø§Ø¨Ù„ Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ
3. Volatility-aware
4. Ú©Ø¯ ØªÙ…ÛŒØ² Ùˆ Ú©ÙˆØªØ§Ù‡
5. Ú©Ù…ØªØ± Ù…Ø³ØªØ¹Ø¯ Ø®Ø·Ø§

âŒ **Ù†Ù‚Ø§Ø· Ø¶Ø¹Ù:**
1. Pattern info Ø±Ø§ Ù†Ø§Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒÚ¯ÛŒØ±Ø¯
2. S/R ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ TP (Ù†Ù‡ SL)
3. RR Ø«Ø§Ø¨Øª (Ø§Ù†Ø¹Ø·Ø§Ù Ú©Ù…ØªØ±)
4. Safety checks Ú©Ù…ØªØ±

### 8.2 Ø¬Ø¯ÙˆÙ„ Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ

| Ù…Ø¹ÛŒØ§Ø± | Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ | Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ | Ø¨Ø±Ù†Ø¯Ù‡ |
|-------|------------|------------|-------|
| **Ø¯Ù‚Øª (Accuracy)** | 9/10 | 7/10 | **Ù‚Ø¯ÛŒÙ…ÛŒ** |
| **Ø³Ø§Ø¯Ú¯ÛŒ (Simplicity)** | 4/10 | 9/10 | **Ø¬Ø¯ÛŒØ¯** |
| **Ù‚Ø§Ø¨Ù„ Ø§Ø¹ØªÙ…Ø§Ø¯ (Reliability)** | 7/10 | 9/10 | **Ø¬Ø¯ÛŒØ¯** |
| **Context-Awareness** | 9/10 | 6/10 | **Ù‚Ø¯ÛŒÙ…ÛŒ** |
| **Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ (Maintenance)** | 5/10 | 9/10 | **Ø¬Ø¯ÛŒØ¯** |
| **Safety** | 9/10 | 7/10 | **Ù‚Ø¯ÛŒÙ…ÛŒ** |
| **Performance** | 7/10 | 9/10 | **Ø¬Ø¯ÛŒØ¯** |

**Ø§Ù…ØªÛŒØ§Ø² Ú©Ù„ÛŒ:**
- Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ: **50/70** = 71%
- Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯: **56/70** = **80%**

### 8.3 ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§

#### Ø¨Ø±Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯:

1. **Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Pattern-based SL/TP** (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
   ```python
   # Ø§Ú¯Ø± Harmonic Pattern Ù‚ÙˆÛŒ ÛŒØ§ÙØª Ø´Ø¯
   if harmonic_pattern and pattern.quality > 0.8:
       use_pattern_sl_tp = True
   ```

2. **Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² S/R Ø¨Ø±Ø§ÛŒ SL** (Ù†Ù‡ ÙÙ‚Ø· TP)
   ```python
   # Ø§Ú¯Ø± S/R Ù†Ø²Ø¯ÛŒÚ© Ùˆ Ù…Ø¹ØªØ¨Ø± Ø¨ÙˆØ¯
   if nearest_support and distance < 2 * atr:
       sl = nearest_support * 0.999
   ```

3. **RR Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ… Ø¨Ø± Ø§Ø³Ø§Ø³ regime**
   ```python
   rr_multipliers = {
       'trending': 2.5,
       'ranging': 1.5,
       'volatile': 2.0
   }
   ```

4. **Ø§ÙØ²ÙˆØ¯Ù† Safety Checks Ø¨ÛŒØ´ØªØ±**

#### Ø¨Ø±Ø§ÛŒ Ø­ÙØ¸ Ù…Ø²Ø§ÛŒØ§ÛŒ Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…:

1. **Ù…Ø§Ú˜ÙˆÙ„Ø§Ø± Ú©Ø±Ø¯Ù† Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ SL/TP**
   ```python
   class StopLossCalculator:
       def calculate_from_pattern(...)
       def calculate_from_sr(...)
       def calculate_from_atr(...)
   ```

2. **Testing Ùˆ Validation Ø¨ÛŒØ´ØªØ±**

### 8.4 Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ

**Ø¨Ø±Ù†Ø¯Ù‡ Ú©Ù„ÛŒ: Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ (80% vs 71%)**

Ø¨Ø§ Ø§ÛŒÙ† Ø­Ø§Ù„ØŒ **Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ… Ø¯Ø± context-awareness Ø¨Ø±ØªØ± Ø§Ø³Øª**.

**ØªÙˆØµÛŒÙ‡ ØªØ±Ú©ÛŒØ¨ÛŒ:**
```
Base: Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ (ATR-based)
+
Enhancement: Pattern-specific SL/TP (Ø§Ø² Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…)
=
Ø¨Ù‡ØªØ±ÛŒÙ† ØªØ±Ú©ÛŒØ¨!
```

Ø§ÛŒÙ† ØªØ±Ú©ÛŒØ¨ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯:
- Ø³Ø§Ø¯Ú¯ÛŒ Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯ Ø±Ø§ Ø­ÙØ¸ Ú©Ù†Ø¯
- Ø¯Ù‚Øª Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ… Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†Ø¯
- Ù‚Ø§Ø¨Ù„ Ø§Ø¹ØªÙ…Ø§Ø¯ Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ Ø¢Ø³Ø§Ù† Ø¨Ø§Ø´Ø¯

---

**Ù¾Ø§ÛŒØ§Ù† Ù…Ù‚Ø§ÛŒØ³Ù‡**

Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨ÛŒØ´ØªØ±:
- Ø³ÛŒØ³ØªÙ… Ù‚Ø¯ÛŒÙ…ÛŒ: `Old_bot/Old_signal.md` (Ø¨Ø®Ø´ 6.2)
- Ø³ÛŒØ³ØªÙ… Ø¬Ø¯ÛŒØ¯: `signal_generation/orchestrator.py` (Ø®Ø·ÙˆØ· 635-693)
